<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/head :: head('Registrar venta')}"></head>
<body>
<div th:replace="~{fragments/navbar :: navbar}"></div>
<div class="container">
    <div class="card">
        <h2 th:text="'Venta / mantenciÃ³n para ' + ${customer.name}">Venta</h2>
        <form th:object="${saleForm}"
              th:action="@{'/customers/' + ${customer.id} + '/sales'}"
              method="post"
              data-disable-on-submit="true"
              data-testid="sale-form">
            <label>Detalle</label>
            <textarea th:field="*{detail}" data-testid="sale-detail"></textarea>
            <div th:if="${#fields.hasErrors('detail')}" th:errors="*{detail}"></div>

            <label>Fecha</label>
            <input type="date" th:field="*{date}" th:value="${#temporals.format(#temporals.createNow(), 'yyyy-MM-dd')}" data-testid="sale-date">
            <div th:if="${#fields.hasErrors('date')}" th:errors="*{date}"></div>

            <label>Cantidad de prendas</label>
            <input type="number" min="1" th:field="*{itemsCount}" data-testid="sale-items">
            <div th:if="${#fields.hasErrors('itemsCount')}" th:errors="*{itemsCount}"></div>

            <label>Monto</label>
            <input type="text" inputmode="numeric" data-money-input="true" th:field="*{amount}" data-testid="sale-amount">
            <div th:if="${#fields.hasErrors('amount')}" th:errors="*{amount}"></div>
            <p class="future-balance"
               data-balance-preview
               data-balance-mode="increase"
               th:attr="data-balance-current=${customer.debt}"
               th:text="'Saldo luego de registrar: ' + ${T(cl.casero.migration.util.CurrencyUtil).format(customer.debt)}"
               data-testid="sale-balance-preview">
                Saldo luego de registrar: $0
            </p>
            <button type="submit" data-loading-text="Registrando venta..." data-testid="sale-submit">Registrar venta</button>
        </form>
    </div>
</div>
</body>
</html>
