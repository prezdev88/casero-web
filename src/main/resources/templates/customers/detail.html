<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/head :: head('Cliente')"></head>
<body>
<div th:replace="fragments/navbar :: navbar"></div>
<div class="container">
    <div th:replace="fragments/messages :: messages"></div>

    <div class="card">
        <h2 th:text="${customer.name}">Cliente</h2>
        <p class="highlight-debt"
           th:classappend="${customer.debt > 0} ? ' text-red' : ' text-blue'">
            <strong>Deuda actual:</strong>
            <strong th:text="${T(cl.casero.migration.util.CurrencyUtil).format(customer.debt)}">$0</strong>
        </p>
        <p><strong>Nombre:</strong> <span th:text="${customer.name}">Nombre</span>
            <a class="icon-button" title="Editar nombre"
               th:href="@{'/customers/' + ${customer.id} + '/actions/name/edit'}">锔</a>
        </p>
        <p><strong>Sector:</strong> <span th:text="${customer.sector.name}">Sector</span></p>
        <p><strong>Direcci贸n:</strong> <span th:text="${customer.address}">Direcci贸n</span>
            <a class="icon-button" title="Editar direcci贸n"
               th:href="@{'/customers/' + ${customer.id} + '/actions/address/edit'}">锔</a>
        </p>
    </div>

    <div class="card">
        <h3>Men煤 de acciones</h3>
        <ul class="action-menu">
            <li><a th:href="@{'/customers/' + ${customer.id} + '/actions/payment'}">Abonar</a></li>
            <li><a th:href="@{'/customers/' + ${customer.id} + '/actions/sale'}">Mantenci贸n</a></li>
            <li><a th:href="@{'/customers/' + ${customer.id} + '/actions/refund'}">Devoluci贸n</a></li>
            <li><a th:href="@{'/customers/' + ${customer.id} + '/actions/forgiveness'}">CONDONAR DEUDA</a></li>
        </ul>
    </div>

    <div class="card">
        <h3>Transacciones</h3>
        <div class="table-wrapper">
            <table>
                <thead>
                <tr>
                    <th>
                        <a th:href="@{'/customers/' + ${customer.id} + '?ascending=' + ${!ascending}}"
                           th:text="'Fecha ' + (ascending ? '(Asc)' : '(Desc)')">
                            Fecha
                        </a>
                    </th>
                    <th>Tipo</th>
                    <th>Detalle</th>
                    <th>Monto</th>
                    <th>Saldo</th>
                    <th></th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="transaction : ${transactionsPage.content}">
                    <td th:text="${T(cl.casero.migration.util.DateUtil).format(transaction.date)}">01-01-2024</td>
                    <td th:text="${transaction.type.displayName}">Venta</td>
                    <td th:text="${transaction.detail}">Detalle</td>
                    <td th:text="${T(cl.casero.migration.util.CurrencyUtil).format(transaction.amount)}">$0</td>
                    <td th:text="${T(cl.casero.migration.util.CurrencyUtil).format(transaction.balance)}">$0</td>
                    <td>
                        <form th:action="@{'/customers/transactions/' + ${transaction.id} + '/delete'}"
                              method="post"
                              onsubmit="return confirm('驴Seguro que deseas eliminar esta transacci贸n?');">
                            <input type="hidden" name="customerId" th:value="${customer.id}">
                            <button type="submit" class="btn-danger" title="Eliminar transacci贸n"></button>
                        </form>
                    </td>
                </tr>
                <tr th:if="${transactionsPage.empty}">
                    <td colspan="6">Sin transacciones</td>
                </tr>
                </tbody>
            </table>
        </div>
        <nav class="pagination"
             th:if="${transactionsPage.totalPages > 1}"
             th:with="prev=${T(java.lang.Math).max(0, transactionsPage.number - 1)}, next=${T(java.lang.Math).min(transactionsPage.totalPages - 1, transactionsPage.number + 1)}">
            <a th:href="@{|/customers/${customer.id}?ascending=${ascending}&page=${prev}&size=${transactionsPage.size}|}"
               th:classappend="${!transactionsPage.hasPrevious()} ? ' disabled'"
               aria-label="P谩gina anterior">Anterior</a>
            <span class="current" th:text="${transactionsPage.number + 1} + ' / ' + ${transactionsPage.totalPages}">1 / 1</span>
            <a th:href="@{|/customers/${customer.id}?ascending=${ascending}&page=${next}&size=${transactionsPage.size}|}"
               th:classappend="${!transactionsPage.hasNext()} ? ' disabled'"
               aria-label="P谩gina siguiente">Siguiente</a>
        </nav>
    </div>

    
</div>
</body>
</html>
