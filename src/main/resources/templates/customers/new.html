<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/head :: head('Nuevo Cliente')}"></head>
<body>
<div th:replace="~{fragments/navbar :: navbar}"></div>
<div class="container">
    <div class="card">
        <h2>Crear Cliente</h2>
        <p>Total de clientes actuales: <strong th:text="${customersCount}">0</strong></p>
        <form th:object="${customerForm}" th:action="@{/customers}" method="post" data-testid="customer-create-form">
            <label>Nombre</label>
            <input type="text" th:field="*{name}" data-testid="customer-name">
            <div th:if="${#fields.hasErrors('name')}" th:errors="*{name}"></div>

            <label>Sector</label>
            <select th:field="*{sectorId}" data-testid="customer-sector">
                <option th:each="sector : ${sectors}"
                        th:value="${sector.id}"
                        th:selected="${customerForm.sectorId == null ? sector.name.equals('Santa Cruz') : sector.id == customerForm.sectorId}"
                        th:text="${sector.name}">Sector</option>
            </select>
            <div th:if="${#fields.hasErrors('sectorId')}" th:errors="*{sectorId}"></div>
            <div th:if="${sectors.isEmpty()}" style="color:#b71c1c;">
                No hay sectores configurados. Agrega registros en la base antes de crear clientes.
            </div>

            <label>Direcci√≥n</label>
            <input type="text" th:field="*{address}" data-testid="customer-address">
            <div th:if="${#fields.hasErrors('address')}" th:errors="*{address}"></div>

            <button type="submit" data-testid="customer-create-submit">Crear</button>
        </form>
    </div>
</div>
</body>
</html>
